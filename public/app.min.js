!function(t){var o={};function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=0)}([function(t,o,e){"use strict";$.widget("custom.combobox",{_create:function(){this.wrapper=$("<span>").addClass("combobox").insertAfter(this.element),this.element.hide(),this._createAutocomplete(),this._createShowAllButton()},_createAutocomplete:function(){var t=this.element.children(":selected");t.val()&&t.text();this.input=$("<input>").appendTo(this.wrapper).val("").attr("required",!0).attr("placeholder","Select an Option...").addClass("combobox-input").autocomplete({delay:0,minLength:0,source:$.proxy(this,"_source")}).tooltip({classes:{"ui-tooltip":"ui-state-highlight"}}),this._on(this.input,{autocompleteselect:function(t,o){o.item.option.selected=!0,this._trigger("select",t,{item:o.item.option}),this.input.autocomplete("search","")},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var t=this.input,o=!1;$("<a>").attr("tabIndex",-1).appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("combobox-toggle").on("mousedown",function(){o=t.autocomplete("widget").is(":visible")}).on("click",function(){t.trigger("focus"),o||t.autocomplete("search","")})},_source:function(t,o){var e=new RegExp("^"+$.ui.autocomplete.escapeRegex(t.term),"i");o(this.element.children("option").map(function(){var o=$(this).text();if(this.value&&(!t.term||e.test(o)))return{label:o,value:o,option:this}}))},_removeIfInvalid:function(t,o){if(!o.item){var e=this.input.val(),n=e.toLowerCase(),i=!1;this.element.children("option").each(function(){if($(this).text().toLowerCase()===n)return this.selected=i=!0,!1}),i||(this.input.val("").attr("title",e+" didn't match any item").tooltip("open"),this.element.val(""),this._delay(function(){this.input.tooltip("close").attr("title","")},2500),this.input.autocomplete("instance").term="")}},_destroy:function(){this.wrapper.remove(),this.element.show()}});var n={init:function(){$("#location").combobox({select:function(t,o){var e=o.item.value;$.ajax({url:"/api/technicians",type:"GET",data:{location_id:e},success:function(t){n.populateTechs(t)},error:function(t){console.log("Error:",t)}})}}),$(".form-control.location .combobox-input").on("autocompleteselect",function(){$(".form-control.technician .combobox-input").val(""),$(".form-control.job-type .combobox-input").val("")}),$("#hours").on("change",function(){var t=parseFloat($(this).val());(t=((t=Math.round(4*t))/4).toFixed(2))>12&&(t=12..toFixed(2)),$(this).val(t)}),$("button#complete").on("click",function(t){t.preventDefault(),$(window).scrollTop(0),location.reload()})},populateTechs:function(t){var o=$("#technician");o.empty(),$("combobox-input").prop("value",""),t.forEach(function(t){o.append('<option value="'+t.value+'">'+t.label+"</option>")}),o.combobox({select:function(t,o){o.item.value;$.ajax({url:"/api/job-types",type:"GET",success:function(t){n.populateJobTypes(t)},error:function(t){console.log("Error",t)}})}}),n.getJobTypes},populateJobTypes:function(t){var o=$("#job-type");o.empty(),t.forEach(function(t){o.append('<option value="'+t.value+'">'+t.label+"</option>")}),o.combobox()}};$("#time-entry,#locate-record").length&&n.init();var i={init:function(){$('form[name="time-entry"]').on("submit",function(t){t.preventDefault(),$('form[name="time-entry"] button').attr("disabled",!0);var o=$(this).serialize();$.ajax({url:"/api/time-logs",type:"POST",data:o,success:function(t){i.addRow(t),$("form button").attr("disabled",!1),$(".form-control.job-type .combobox-input").val(""),$("#job-name").val(""),$("#comment").val(""),$("#hours").val("")},error:function(t){console.log("Error",t)}})})},addRow:function(t){var o=$("tr#clone").clone();o.removeAttr("id"),o.attr("id","record-"+t.record_no),o.find(".edit-button").data("record",t.record_no),o.find(".date").html(moment(t.log_date).format("M/D/Y")),o.find(".location").html(t.loc_short_name),o.find(".technician").html(t.technician_name),o.find(".job-type").html(t.job_type),o.find(".job-name").html(t.job_name),o.find(".hours").html(t.log_hours),o.find(".comment").html(t.job_comment);var e=$("tbody.logs tr:last");e.length>0?o.insertAfter(e):$("tbody.logs").append(o);i.recalculateTotal()},recalculateTotal:function(){var t=0;$(".logs .hours").each(function(o,e){var n=parseFloat($(e).html());t+=n}),$("tr.total-row td.total").html(t.toFixed(2))}};$("#time-entry").length&&i.init();var a={init:function(){$('form[name="locate-record"]').on("submit",function(t){t.preventDefault(),$('form[name="locate-record"] button').attr("disabled",!0);var o=$(this).serialize();$.ajax({url:"/api/time-logs",type:"GET",data:o,success:function(t){a.addRows(t),$("form button").attr("disabled",!1)},error:function(t){console.log("Error",t)}})}),$("button#clear").on("click",function(){$("tbody.logs").empty(),i.recalculateTotal()})},addRows:function(t){$("tbody.logs").empty(),t.forEach(function(t){i.addRow(t)}),i.recalculateTotal()}};$("#locate-record").length&&a.init();var r={data:null,init:function(){$("body").on("click",".edit-button",function(t){t.preventDefault();var o=$(this).data("record");r.loadLog(o)}),$(".shadow").on("click",function(){$("#edit-modal").removeClass("visible")}),$('form[name="time-edit"]').on("submit",function(t){t.preventDefault();var o=$(this).serialize();r.submitForm(o)}),$("#hours-edit").on("change",function(){var t=parseFloat($(this).val());(t=((t=Math.round(4*t))/4).toFixed(2))>12&&(t=12..toFixed(2)),$(this).val(t)})},loadLog:function(t){$.ajax({url:"/api/time-logs/"+t,type:"GET",success:function(t){r.data=t,console.log(r.data),r.getTechs()},error:function(t){console.log("Error",t)}}),console},getTechs:function(){$.ajax({url:"/api/technicians",type:"GET",data:{location_id:r.data.location_id},success:function(t){r.populateTechs(t)},error:function(t){console.log("Error",t)}})},populateTechs:function(t){console.log("Techs:",r.data,t);var o=$("#technician-edit");t.forEach(function(t){o.append('<option value="'+t.value+'">'+t.label+"</option>")}),this.getJobTypes()},getJobTypes:function(){console.log("get types"),$.ajax({url:"/api/job-types",type:"GET",success:function(t){r.populateJobTypes(t)},error:function(t){console.log("Error",t)}})},populateJobTypes:function(t){console.log("populate types");var o=$("#job-type-edit");o.empty(),t.forEach(function(t){o.append('<option value="'+t.value+'">'+t.label+"</option>")}),this.fillModalData()},fillModalData:function(){console.log("Fill Data:",r.data);var t=$("#date-edit"),o=$("#location-edit"),e=$("#technician-edit"),n=$("#job-type-edit"),i=$("#job-name-edit"),a=$("#comment-edit"),l=$("#hours-edit");t.val(r.data.log_date),o.find('option[value="'+r.data.location_id+'"]').attr("selected",!0),e.find('option[value="'+r.data.technician_id+'"]').attr("selected",!0),n.find('option[value="'+r.data.job_type+'"]').attr("selected",!0),i.val(r.data.job_name),a.html(r.data.job_comment),l.val(r.data.log_hours),$("#edit-modal").addClass("visible")},submitForm:function(t){$.ajax({url:"/time-logs/"+r.data.record_no,type:"PUT",data:t,success:function(t){r.updateRow(t)},error:function(t){console.log("Error",t)}})},updateRow:function(t){var o=$("tr#record-"+t.record_no);0==o.length&&((o=$("tr#record-"+t.record_no_source)).attr("id","record-"+t.record_no),o.find(".edit-button").data("record",t.record_no)),o.find(".date").html(moment(t.log_date).format("M/D/Y")),o.find(".location").html(t.loc_short_name),o.find(".technician").html(t.technician_name),o.find(".job-type").html(t.job_type),o.find(".job-name").html(t.job_name),o.find(".hours").html(t.log_hours),o.find(".comment").html(t.job_comment),i.recalculateTotal(),$("#edit-modal").removeClass("visible")}};r.init();var l={init:function(){$('form[name="identify"]').on("submit",function(t){t.preventDefault();var o=$(this).serialize();l.submitForm(o)})},submitForm:function(t){$.ajax({url:"/identify",type:"POST",data:t,success:function(){l.hidePrompt()},error:function(t){console.log("Error",t)}})},hidePrompt:function(){$("#identify").removeClass("visible")}};$("#identify").length&&l.init()}]);
//# sourceMappingURL=app.min.js.map